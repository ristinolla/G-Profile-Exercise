var app=angular.module("profileApp",["ngRoute","profileControllers","loginController"]);app.config(["$routeProvider",function(e){console.log("Routerprovider started"),e.when("/profile",{templateUrl:"partials/profile.html",controller:"ProfileCtrl"}).when("/login",{templateUrl:"partials/login.html",controller:"LoginCtrl"}).otherwise({redirectTo:"/login"})}]),app.service("ApiService",function(e,o){function n(e){return o.reject(angular.isObject(e.data)&&e.data.message?e.data.message:e.data)}function t(e){return e.data}var i={};return i.connect=function(o){var i=e({method:"post",url:"/api/connect?state="+STATE,data:o.code,contentType:"application/octet-stream; charset=utf-8"});return i.then(t,n)},i.disconnect=function(o){console.log("Disconnext in services");var i=e({method:"post",url:"/api/disconnect",data:{token:o.access_token},contentType:"application/octet-stream; charset=utf-8"});return i.then(t,n)},i.getProfile=function(){console.log("ApiService.getProfile");var o=e({method:"get",url:"/api/profile",contentType:"application/octet-stream; charset=utf-8"});return o.then(t,n)},i.getPeople=function(){console.log("ApiService.getPeople");var o=e({method:"get",url:"/api/people",contentType:"application/octet-stream; charset=utf-8"});return o.then(t,n)},i}),app.factory("OauthService",function(e,o,n){var t={};return t.isSignedIn=!1,t.processAuth=function(e){console.log("aurg",e);var t=o.defer();return this.isSignedIn&&t.resolve({signedIn:!0,message:"Already signed in."}),e.access_token?(this.immediateFailed=!1,n.connect(e).then(function(e){console.log("Login succesfull, status: ",e),t.resolve({signedIn:!0,message:e})},function(e){console.log("Connection failed because: ",e),t.resolve({signedIn:!1,message:e})})):e.error&&("immediate_failed"===e.error?(this.immediateFailed=!0,t.resolve({signedIn:!1,message:"Immediate Connection failed"})):(console.log("severe amount of shit in the fan"),t.resolve({signedIn:!1,message:e.error}))),t.promise},t.disconnect=function(e){var t=o.defer();return n.disconnect(e).then(function(e){this.isSignedIn=!1,t.resolve({signedOut:!0,message:e})}),t.promise},t});var loginController=angular.module("loginController",[]);loginController.controller("LoginCtrl",function(e,o,n){e.isSignedIn=n.isSignedIn,e.immediateFailed=!1,e.authResult={},e.errorMessage=!1,e.profile={},e.people={},e.disconnect=function(){n.disconnect(e.authResult).then(function(o){console.log(o),e.isSignedIn=!1,e.profile={},e.people={}})},e.signIn=function(o){console.log(this),e.$apply(function(){e.authResult=o,n.processAuth(o).then(function(o){console.log(o),o.signedIn===!0?e.isSignedIn=!0:(e.isSignedIn=!1,console.log(o.message),e.handleError(o))})})},e.handleError=function(o){e.errorMessage=o.message},e.renderSignIn=function(){return gapi.signin.render("gPlusSignIn",{callback:e.signIn,clientid:"391956554891-0spjspmirtm07e9l9tsjl1ntkdpcmle5.apps.googleusercontent.com",requestvisibleactions:"http://schemas.google.com/AddActivity",scope:"https://www.googleapis.com/auth/plus.login https://www.googleapis.com/auth/userinfo.email",theme:"dark",cookiepolicy:"single_host_origin",accesstype:"offline"})}});var profileControllers=angular.module("profileControllers",[]);profileControllers.controller("ProfileCtrl",function(e,o,n){e.profile={},console.log("Profile ctrl"),n.isSignedIn===!0?(o.getProfile().then(function(o){console.log("Profile object",o),e.profile=o,e.profile.image.bigUrl=o.image.url.split("?")[0]}),o.getPeople().then(function(o){console.log("People object",o),e.people=o})):console.log("dd")});